<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>æ‰˜ä¸šè¯æ±‡ï½œç¬¬1ç«  åŠå…¬å®¤äº‹å®œï¼ˆOffice matters 1ï¼‰</title>
<style>
  :root{
    --bg:#ffffff; --fg:#0f172a; --muted:#607087; --brand:#16a34a; --brand2:#0ea5e9;
    --card:#f8fafc; --line:#e5e7eb; --warn:#ef4444; --ok:#22c55e; --amber:#f59e0b;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;font-family:ui-sans-serif,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial}
  header{position:sticky;top:0;background:linear-gradient(90deg,#fff, #f0f9ff);border-bottom:1px solid var(--line);padding:12px 16px;display:flex;gap:12px;align-items:center;z-index:10}
  header h1{font-size:18px;margin:0;color:var(--fg);font-weight:700}
  .chip{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--line);padding:6px 10px;border-radius:999px;background:#fff}
  .chip label{font-size:12px;color:var(--muted)}
  .chip select{border:none;background:transparent;outline:none;font-size:14px;color:var(--fg)}
  main{max-width:1080px;margin:0 auto;padding:20px 16px 60px}
  .section-title{display:flex;align-items:center;gap:10px;margin:20px 0 10px}
  .section-title h2{margin:0;font-size:18px}
  .grid{display:grid;grid-template-columns:1fr;gap:16px}
  @media(min-width:900px){.grid{grid-template-columns:1.1fr .9fr}}
  .card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:16px;box-shadow:0 2px 8px rgba(15,23,42,.05)}
  .flash{display:flex;flex-direction:column;gap:12px}
  .word{display:flex;align-items:baseline;gap:10px}
  .word b{font-size:28px;color:var(--fg)}
  .ipa{font-family: "SF Mono","JetBrains Mono",ui-monospace,Menlo,Consolas,monospace;font-size:14px;color:var(--muted)}
  .def{font-size:15px;line-height:1.6;color:#0f172a;background:#fff;border:1px dashed var(--line);border-radius:12px;padding:12px}
  .actions{display:flex;gap:10px;flex-wrap:wrap}
  button{cursor:pointer;border:1px solid var(--line);padding:10px 14px;border-radius:999px;background:#fff;color:#0f172a;font-weight:600}
  button:hover{border-color:#cbd5e1;box-shadow:0 1px 4px rgba(2,6,23,.06)}
  .btn-ok{background:linear-gradient(90deg,#10b981,#22c55e);color:#fff;border:none}
  .btn-no{background:#fff;border:2px solid var(--warn);color:#b91c1c}
  .btn-maybe{background:#fff;border:2px solid var(--amber);color:#92400e}
  .tiny{font-size:12px;color:var(--muted)}
  .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .pill{padding:4px 8px;border-radius:999px;border:1px solid var(--line);background:#fff;color:var(--muted);font-size:12px}
  .quiz{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
  .tile{user-select:none;background:#fff;border:2px solid var(--line);border-radius:12px;padding:12px;min-height:56px;display:flex;align-items:center;justify-content:center;text-align:center;font-weight:700;transition:.15s}
  .tile.eng{color:#111827}
  .tile.cn{color:#0f766e}
  .tile:hover{transform:translateY(-2px);box-shadow:0 4px 14px rgba(2,6,23,.06)}
  .tile.selected{border-color:var(--brand2);outline:3px solid rgba(14,165,233,.2)}
  .tile.ok{animation:blinkok .35s 2}
  .tile.bad{animation:blinkbad .35s 2}
  @keyframes blinkok{50%{background:#dcfce7;border-color:#22c55e}}
  @keyframes blinkbad{50%{background:#fee2e2;border-color:#ef4444}}
  .footer-note{margin-top:10px;color:var(--muted);font-size:13px}
  .kbd{font-family:ui-monospace,Menlo,Consolas,monospace;background:#eef2ff;border:1px solid #c7d2fe;border-radius:6px;padding:2px 6px}
  .divider{height:1px;background:var(--line);margin:8px 0 16px}
  .hidden{display:none}
  .notice{background:#fff7ed;border:1px solid #fed7aa;color:#92400e;padding:10px 12px;border-radius:10px;font-size:14px}
</style>
</head>
<body>
<header>
  <h1>ç¬¬1ç«  åŠå…¬å®¤äº‹å®œï¼ˆOffice matters 1ï¼‰</h1>
  <div class="chip">
    <label for="dial">å‘éŸ³ / éŸ³æ ‡ï¼š</label>
    <select id="dial">
      <option value="us">ç¾éŸ³ï¼ˆAmericanï¼‰</option>
      <option value="uk">è‹±éŸ³ï¼ˆBritishï¼‰</option>
    </select>
  </div>
</header>

<main>
  <div class="grid">
    <!-- å·¦ä¾§ï¼šé—ªå¡ -->
    <section class="card">
      <div class="section-title">
        <h2>å•è¯é—ªå¡</h2>
        <span class="tiny">ç‚¹å‡»å–‡å­ â–¶ï¸ å¯å‘éŸ³ï¼›å­¦å®Œå°†è‡ªåŠ¨è§£é”å³ä¾§æµ‹è¯•</span>
      </div>
      <div id="flashwrap" class="flash"></div>
    </section>

    <!-- å³ä¾§ï¼šæµ‹è¯•ï¼ˆå®Œæˆé—ªå¡åæ˜¾ç¤ºï¼‰ -->
    <section id="quizSection" class="card hidden">
      <div class="section-title">
        <h2>æµ‹è¯•ï¼šè‹±ä¸­é…å¯¹ã€Œæ¶ˆæ¶ˆä¹ã€</h2>
        <span class="tiny">åŒ¹é…æ­£ç¡®åé—ªçƒæ¶ˆå¤±ï¼Œé”™è¯¯å°†ä¿ç•™</span>
      </div>
      <div id="quiz" class="quiz"></div>
      <div class="footer-note">
        å°æç¤ºï¼šå¯éšæ—¶åˆ‡æ¢ä¸Šæ–¹å£éŸ³ï¼›æµ‹è¯•ä½¿ç”¨ä¸æœ¬ç« ç›¸åŒçš„è¯æ±‡ä¸é‡Šä¹‰ã€‚
      </div>
    </section>
  </div>

  <div class="divider"></div>
  <p class="tiny">
    æ•°æ®æ¥æºï¼šã€Šæ‰˜ä¸šè¯æ±‡&çŸ­è¯­&é‡‘èè‹±è¯­å½’çº³è®²ä¹‰ã€‹ç¬¬ä¸€ç« â€œåŠå…¬å®¤äº‹å®œ Office mattersï¼ˆ1ï¼‰â€
  </p>
</main>

<script>
/* -------------------- è¯è¡¨ -------------------- */
const WORDS = [
  {w:"appointment", cn:"çº¦ä¼šï¼›çº¦å®š", ipa:{us:"/É™ËˆpÉ”ÉªntmÉ™nt/", uk:"/É™ËˆpÉ”ÉªntmÉ™nt/"}},
  {w:"attendance", cn:"å‡ºå¸­äººæ•°ï¼›å‡ºå¸­", ipa:{us:"/É™ËˆtendÉ™ns/", uk:"/É™ËˆtendÉ™ns/"}},
  {w:"cabinet", cn:"æ©±æŸœ", ipa:{us:"/ËˆkÃ¦bÉªnÉ™t/", uk:"/ËˆkÃ¦bÉªnÉªt/"}},
  {w:"calendar", cn:"æ—¥å†ï¼›æœˆå†ï¼›è¡Œäº‹å†", ipa:{us:"/ËˆkÃ¦lÉªndÉ™r/", uk:"/ËˆkÃ¦lÉªndÉ™/"}},
  {w:"clerk", cn:"åŠäº‹å‘˜ï¼›ä¹¦è®°", ipa:{us:"/klÉœËrk/", uk:"/klÉ‘Ëk/"}},
  {w:"directory", cn:"äººåä½å€ç°¿ï¼›åå½•", ipa:{us:"/dÉªËˆrektÉ™ri, daÉª-/", uk:"/dÉªËˆrektÉ™ri/"}},
  {w:"duplicate", cn:"å¤åˆ¶ï¼›å‰¯æœ¬", ipa:{us:"/ËˆduËplÉªkÉ™t/", uk:"/ËˆdjuËplÉªkÉ™t/"}},
  {w:"filing", cn:"å½’æ¡£", ipa:{us:"/ËˆfaÉªlÉªÅ‹/", uk:"/ËˆfaÉªlÉªÅ‹/"}},
  {w:"in-tray", cn:"å¾…å¤„ç†æ–‡ä»¶ç›’", ipa:{us:"/ËˆÉªn treÉª/", uk:"/ËˆÉªn treÉª/"}},
  {w:"monitor", cn:"æ£€æµ‹ï¼›ç›‘è§†ï¼›è¿½è¸ª", ipa:{us:"/ËˆmÉ‘ËnÉªtÉ™r/", uk:"/ËˆmÉ’nÉªtÉ™/"}},
  {w:"out-tray", cn:"å·²å¤„ç†æ–‡ä»¶ç›’", ipa:{us:"/ËˆaÊŠt treÉª/", uk:"/ËˆaÊŠt treÉª/"}},
  {w:"partition", cn:"åˆ†éš”ï¼›åˆ†éš”ç‰©", ipa:{us:"/pÉ‘ËrËˆtÉªÊƒÉ™n/", uk:"/pÉ‘ËËˆtÉªÊƒ(É™)n/"}},
  {w:"postage", cn:"é‚®è´¹", ipa:{us:"/ËˆpoÊŠstÉªdÊ’/", uk:"/ËˆpÉ™ÊŠstÉªdÊ’/"}},
  {w:"punctuality", cn:"å‡†æ—¶ï¼›å®ˆæ—¶", ipa:{us:"/ËŒpÊŒÅ‹ktÊƒuËˆÃ¦lÉ™ti/", uk:"/ËŒpÊŒÅ‹ktÊƒuËˆÃ¦lÉªti/"}},
  {w:"schedule", cn:"æ—¶é—´è¡¨ï¼›è®¡åˆ’è¡¨", ipa:{us:"/ËˆskedÊ’uËl/", uk:"/ËˆÊƒedjuËl/"}},
  {w:"shift", cn:"æ¢ç­ï¼›è½®ç­ï¼›å€¼ç­", ipa:{us:"/ÊƒÉªft/", uk:"/ÊƒÉªft/"}},
  {w:"staff", cn:"å…¨ä½“èŒå‘˜", ipa:{us:"/stÃ¦f/", uk:"/stÉ‘Ëf/"}},
  {w:"strike", cn:"ç½¢å·¥", ipa:{us:"/straÉªk/", uk:"/straÉªk/"}},
  {w:"task", cn:"å·¥ä½œï¼›ä»»åŠ¡", ipa:{us:"/tÃ¦sk/", uk:"/tÉ‘Ësk/"}},
  {w:"workforce", cn:"å·¥ä½œäººå‘˜ï¼›åŠ³åŠ¨äººå£", ipa:{us:"/ËˆwÉœËrkfÉ”Ërs/", uk:"/ËˆwÉœËkfÉ”Ës/"}}
];

/* -------------------- å­¦ä¹ çŠ¶æ€ -------------------- */
let deck = WORDS.map((x, i) => ({...x, id:i}));
let reviewQueue = [];
const learned = new Set();
let currentCard = null;

const dialSel = document.getElementById('dial');
dialSel.addEventListener('change', renderFlash);

function shuffle(arr){
  return arr
    .map(v => ({v, r:Math.random()}))
    .sort((a,b)=>a.r-b.r)
    .map(({v})=>v);
}

function pickNextCard(){
  if (!deck.length && reviewQueue.length){
    deck = shuffle(reviewQueue);
    reviewQueue = [];
  }
  if (!deck.length) return null;
  return deck[0];
}

function removeCurrent(){
  if (deck.length) deck.shift();
}

function enqueueReview(card, times=1){
  for (let i=0;i<times;i++){
    const pos = Math.max(1, Math.floor(Math.random()*(deck.length+3)));
    deck.splice(pos, 0, {...card, ghost:true, ghostId:Math.random()});
  }
}

/* -------------------- æœ—è¯» -------------------- */
function speak(text, dialect){
  const synth = window.speechSynthesis;
  if (!synth) return alert('ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒåˆæˆè¯­éŸ³ã€‚å¯æ­£å¸¸å­¦ä¹ ï¼Œä½†æ— æ³•æœ—è¯»ã€‚');
  const u = new SpeechSynthesisUtterance(text);
  const voices = synth.getVoices();
  const target = dialect==='uk'
    ? (voices.find(v=>/en-GB|en_GB|English \(United Kingdom\)/.test(v.lang || v.name)) || voices.find(v=>/English/.test(v.lang||v.name)))
    : (voices.find(v=>/en-US|en_US|English \(United States\)/.test(v.lang || v.name)) || voices.find(v=>/English/.test(v.lang||v.name)));
  if (target) u.voice = target;
  u.rate = 0.95; u.pitch = 1; u.lang = (dialect==='uk'?'en-GB':'en-US');
  synth.cancel();
  synth.speak(u);
}

/* -------------------- é—ªå¡æ¸²æŸ“ -------------------- */
function renderFlash(){
  const box = document.getElementById('flashwrap');
  box.innerHTML = '';
  currentCard = pickNextCard();

  // æ‰€æœ‰é—ªå¡ç»“æŸï¼šæ˜¾ç¤ºå®Œæˆæç¤ºå¹¶è§£é”æµ‹è¯•
  if (!currentCard){
    const done = document.createElement('div');
    done.innerHTML = `
      <div class="def">ğŸ‰ æ­å–œï¼Œä½ å·²å®Œæˆæœ¬ç« æ‰€æœ‰é—ªå¡ï¼å³ä¾§å·²è§£é”æµ‹è¯•ï¼Œè¯·å‰å¾€å®Œæˆé…å¯¹ç»ƒä¹ ã€‚</div>
      <div class="row">
        <span class="pill">ç´¯è®¡å­¦ä¼šï¼š${learned.size} / ${WORDS.length}</span>
        <button onclick="restartDeck()" title="é‡ç½®å¹¶é‡æ–°ç»ƒä¹ ">é‡æ–°å¼€å§‹æœ¬ç« </button>
      </div>
    `;
    box.appendChild(done);
    showQuiz(); // è§£é”å¹¶æ„å»ºæµ‹è¯•
    return;
  }

  // è¿›è¡Œä¸­ï¼šéšè—æµ‹è¯•åŒº
  hideQuiz();

  const dialect = dialSel.value;
  const ipaText = dialect==='uk' ? currentCard.ipa.uk : currentCard.ipa.us;
  const progress = learned.size; // å·²å­¦ä¼šæ•°é‡

  const wrap = document.createElement('div');
  wrap.innerHTML = `
    <div class="row">
      <span class="pill">è¿›åº¦ï¼š${progress}/${WORDS.length}</span>
      <span class="pill">å‰©ä½™ï¼ˆå«å¤ç°ï¼‰ï¼š${deck.length}</span>
      <span class="pill">æœ¬å¡IDï¼š#${currentCard.id+1}</span>
    </div>
    <div class="word">
      <b>${currentCard.w}</b>
      <button title="å‘éŸ³" aria-label="å‘éŸ³" onclick="speak('${currentCard.w}','${dialSel.value}')">â–¶ï¸ å‘éŸ³</button>
    </div>
    <div class="ipa tiny">éŸ³æ ‡ï¼ˆ${dialect==='uk'?'è‹±éŸ³ / BrE':'ç¾éŸ³ / AmE'}ï¼‰ï¼š<span>${ipaText}</span></div>
    <div class="def"><b>è¾ƒé•¿é‡Šä¹‰ï¼š</b> ${currentCard.cn}</div>
    <div class="actions">
      <button class="btn-ok" onclick="mark('learned')">æˆ‘å­¦ä¼šäº†</button>
      <button class="btn-no" onclick="mark('no')">æˆ‘æ²¡å­¦ä¼š</button>
      <button class="btn-maybe" onclick="mark('maybe')">ä¸å¤ªç¡®å®š</button>
      <span class="tiny">è§„åˆ™ï¼šæ²¡å­¦ä¼šå°†éšæœºå¤ç°2æ¬¡ï¼›ä¸ç¡®å®šå°†å¤ç°1æ¬¡ã€‚</span>
    </div>
  `;
  box.appendChild(wrap);
}

function mark(type){
  if (!currentCard) return;
  // æ°¸è¿œå…ˆç§»é™¤å½“å‰
  removeCurrent();
  if (type==='learned'){
    learned.add(currentCard.id);
  } else if (type==='no'){
    enqueueReview(currentCard, 2);
  } else if (type==='maybe'){
    enqueueReview(currentCard, 1);
  }
  renderFlash();
}

function restartDeck(){
  deck = WORDS.map((x,i)=>({...x,id:i}));
  reviewQueue = [];
  learned.clear?.();
  currentCard = null;
  renderFlash();
}

/* -------------------- æµ‹è¯•ï¼šè‹±ä¸­é…å¯¹ï¼ˆå®Œæˆåæ˜¾ç¤ºï¼‰ -------------------- */
function showQuiz(){
  const sec = document.getElementById('quizSection');
  if (sec.classList.contains('hidden')) sec.classList.remove('hidden');
  buildQuiz();
}

function hideQuiz(){
  const sec = document.getElementById('quizSection');
  if (!sec.classList.contains('hidden')) sec.classList.add('hidden');
}

function buildQuiz(){
  const q = document.getElementById('quiz');
  q.innerHTML = '';
  const eng = WORDS.map(x=>({type:'eng', key:x.w, text:x.w}));
  const cn = WORDS.map(x=>({type:'cn', key:x.w, text:x.cn}));
  const tiles = shuffle([...eng, ...cn]);
  tiles.forEach((t)=>{
    const div = document.createElement('div');
    div.className = `tile ${t.type}`;
    div.dataset.key = t.key;
    div.dataset.type = t.type;
    div.tabIndex = 0;
    div.innerText = t.text;
    div.addEventListener('click', ()=>onTileClick(div));
    q.appendChild(div);
  });
}

let sel = null;
function onTileClick(el){
  if (el.classList.contains('ok')) return;
  if (!sel){
    sel = el;
    el.classList.add('selected');
    return;
  }
  if (sel === el){
    sel.classList.remove('selected');
    sel = null;
    return;
  }
  const match = (sel.dataset.key === el.dataset.key) && (sel.dataset.type !== el.dataset.type);
  if (match){
    flashPair(sel, el, true);
    speak(sel.dataset.key, dialSel.value); // æ­£ç¡®åŒ¹é…å¥–åŠ±å‘éŸ³
    setTimeout(()=>{
      sel.style.visibility = 'hidden';
      el.style.visibility = 'hidden';
      sel.classList.remove('selected'); el.classList.remove('selected');
      sel = null;
      const rest = [...document.querySelectorAll('.tile')].filter(t=>t.style.visibility!=='hidden');
      if (rest.length===0){
        const done = document.createElement('div');
        done.className='def';
        done.style.gridColumn='1 / span 2';
        done.style.background='#ecfeff';
        done.style.border='1px solid #bae6fd';
        done.style.borderRadius='12px';
        done.style.padding='14px';
        done.innerHTML='âœ… æµ‹è¯•å®Œæˆï¼ä½ å·²æˆåŠŸåŒ¹é…æœ¬ç« æ‰€æœ‰è¯æ±‡ã€‚ç‚¹å‡»åˆ·æ–°å¯é‡æ–°æŒ‘æˆ˜ã€‚';
        document.getElementById('quiz').appendChild(done);
      }
    }, 320);
  }else{
    flashPair(sel, el, false);
    sel.classList.remove('selected');
    sel = null;
  }
}

function flashPair(a,b,ok){
  [a,b].forEach(x=>{
    x.classList.remove('ok','bad','selected');
    x.classList.add(ok?'ok':'bad');
    setTimeout(()=>x.classList.remove('ok','bad'), 400);
  });
}

/* -------------------- åˆå§‹åŒ– -------------------- */
renderFlash();
if ('speechSynthesis' in window){
  window.speechSynthesis.onvoiceschanged = () => {};
}
</script>
</body>
</html>
